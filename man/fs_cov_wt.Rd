% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fs_cov_wt.R
\name{fs_cov_wt}
\alias{fs_cov_wt}
\title{Weighted or unweighted covariance and optional correlation}
\usage{
fs_cov_wt(x, wt = NULL, cor = FALSE, center = TRUE, method = "unbiased")
}
\arguments{
\item{x}{A numeric matrix or data frame. Each row is an observation, each
column a variable.}

\item{wt}{Optional numeric vector of weights for each row. Must be
non-negative and sum > 0.}

\item{cor}{Logical. If TRUE, also returns the correlation matrix.}

\item{center}{Logical or numeric vector specifying the column means to use
for centering. If TRUE (default), the weighted or unweighted mean is used.
If a numeric vector is provided, that is used for centering.}

\item{method}{Character string, either "unbiased" (default) or "ML".
"unbiased" divides by 1 - sum(wt^2), "ML" divides by sum(wt).}
}
\value{
A list with the following elements:
\describe{
\item{cov}{The covariance matrix.}
\item{cor}{The correlation matrix, if \code{cor = TRUE}.}
\item{center}{The column means used for centering.}
\item{n.obs}{Number of observations (rows in \code{x}).}
\item{wt}{The normalized weights used, if \code{wt} was provided.}
}
}
\description{
Computes the covariance matrix of a numeric matrix \code{x}, optionally weighted
by a vector \code{wt}. Can also return the correlation matrix. Supports unbiased
or maximum likelihood estimation.
}
\examples{
set.seed(1)
x <- matrix(rnorm(60), nrow = 20, ncol = 3)
wt <- runif(nrow(x))
res1 <- fs_cov_wt(x) # unweighted
res2 <- fs_cov_wt(x, wt, TRUE, method = "ML") # weighted with correlation

}
